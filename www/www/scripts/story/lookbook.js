const related = [{
    img_location: "/images/sample/22-fw-001.jpg",
    img_type: "P",
    title: "Ortei blazer"
},
{
    img_location: "/images/sample/22-fw-002.jpg",
    img_type: "P",
    title: "Small calliotote bag"
},
{
    img_location: "/images/sample/22-fw-003.jpg",
    img_type: "P",
    title: "Ation slacks"
},
{
    img_location: "/images/sample/22-fw-004.jpg",
    img_type: "P",
    title: "Ortei blazer"
},
{
    img_location: "/images/sample/22-fw-005.jpg",
    img_type: "P",
    title: "Small calliotote bag"
},
{
    img_location: "/images/sample/22-fw-006.jpg",
    img_type: "P",
    title: "Ation slacks"
}
]
const lookbook = [{
    img_location: "/images/sample/22-fw-001.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-002.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-003.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-004.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-005.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-006.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-007.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-008.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-009.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-010.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-011.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-012.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-013.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-014.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-015.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-016.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-017.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-018.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-001.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-002.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-003.jpg",
    img_type: "P",
    title: "2022 Fall Winter Collection<br>Phenomenon Communication"
},
{
    img_location: "/images/sample/22-fw-004.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-005.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-006.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-007.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-008.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-009.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-010.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-011.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-012.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-013.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-014.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-015.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-016.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-017.jpg",
    img_type: "P"
},
{
    img_location: "/images/sample/22-fw-018.jpg",
    img_type: "P"
}
]
const lookbookCate = [{
    img_location: "/images/svg/Project1.svg",
    img_title: "product 1"
},
{
    img_location: "/images/svg/Project2.svg",
    img_title: "product 2"
},
{
    img_location: "/images/svg/Project3.svg",
    img_title: "product 3"
},
{
    img_location: "/images/svg/Project4.svg",
    img_title: "product 4"
},
{
    img_location: "/images/svg/Project5.svg",
    img_title: "product 5"
},
{
    img_location: "/images/svg/Project6.svg",
    img_title: "product 6"
},
{
    img_location: "/images/svg/Project7.svg",
    img_title: "product 7"
},
{
    img_location: "/images/svg/Project8.svg",
    img_title: "product 8"
},
{
    img_location: "/images/svg/Project9.svg",
    img_title: "product 9"
},
{
    img_location: "/images/svg/Project10.svg",
    img_title: "product 10"
},
{
    img_location: "/images/svg/Project11.svg",
    img_title: "product 11"
},
{
    img_location: "/images/svg/Project12.svg",
    img_title: "product 12"
},
{
    img_location: "/images/svg/Project13.svg",
    img_title: "product 13"
},
{
    img_location: "/images/svg/Project14.svg",
    img_title: "product 14"
},
{
    img_location: "/images/svg/Project15.svg",
    img_title: "product 15"
}
]
let reverseLookbook = lookbook.reverse();
let reverseLookbookCate = lookbookCate.reverse();

document.addEventListener("DOMContentLoaded", function () {
    loadLookbook();
    imgTypeBtn();
    loadLookbookDetail();
    scrollTop();
    backBtn();
    lookbookClickEvent()
    loadLookbookCategory();
    loadRelated();
    slideClickEvent();
    titleFooterObserver();
    responsive();

});
let timer = null;
window.addEventListener('resize', function () {
    clearTimeout(timer);
    timer = setTimeout(function () {
        responsive();
    }, 300);
});
function imgTypeBtn() {
    let imgBtn = document.querySelector(".image-type-btn");
    imgBtn.addEventListener("click", function () {
        let theme = document.querySelector(':root');
        let styles = getComputedStyle(theme);
        styles.getPropertyValue('--lookbookGrid');
        if (this.dataset.type == "L") {
            theme.style.setProperty('--lookbookGrid', 'repeat(6,1fr)')
            theme.style.setProperty('--grid-column', '1/15');
            this.dataset.type = "S";
            this.children[1].innerHTML = "크게보기"
            this.children[0].src = "/images/svg/grid-cols-3.svg"
        } else if (this.dataset.type == "S") {
            theme.style.setProperty('--lookbookGrid', 'repeat(3,1fr)')
            theme.style.setProperty('--grid-column', '1/17');
            this.dataset.type = "L";
            this.children[1].innerHTML = "작게보기"
            this.children[0].src = "/images/svg/grid-cols-4.svg"

        }
    })
}

function loadLookbookCategory() {
    let lookbookSwiperWrapper = document.querySelector(".lookCategory-swiper .swiper-wrapper");
    lookbookCate.forEach((el, idx) => {
        let {
            img_location,
            img_title
        } = el;
        let slide = appendCategorySlide(img_location, img_title, idx);
        lookbookSwiperWrapper.appendChild(slide);
    })
}

function loadRelated() {
    let relatedSwiperWrapper = document.querySelector(".related-product-swiper .swiper-wrapper");
    related.forEach(el => {
        let {
            img_location,
            title
        } = el;
        let slide = appendRelatedSlide(img_location, title);
        relatedSwiperWrapper.appendChild(slide);
    })
}

function loadLookbook() {
    let lookbookResult = document.querySelector(".lookbook-result");

    reverseLookbook.forEach(el => {
        let {
            img_location,
            img_type,
            title
        } = el;
        let data = appendLookbookHtml(img_location, title);
        lookbookResult.appendChild(data);
    })
}

function loadLookbookDetail() {
    let lookbookDetailSwiperWrapper = document.querySelector(".lookbook-detail-swiper .swiper-wrapper");
    reverseLookbook.forEach(el => {
        let {
            img_location,
            img_type,
            title
        } = el;
        let slide = appendDetailSlide(img_location, title);

        lookbookDetailSwiperWrapper.appendChild(slide);
    })
}

function appendLookbookHtml(src, title) {
    let lookbook = document.createElement("div");
    let titleText = title !== undefined ? title : "";
    let imgHtml = ` <img src="${src}" alt="">`;
    lookbook.className = "lookbook";
    lookbook.innerHTML = imgHtml;
    return lookbook;
}

function appendCategorySlide(src, title, idx) {
    let categorySwiperSlide = document.createElement("div");
    let imgHtml = ` <div class="lookCategory-box">
                        <img src="${src}" alt="">
                    </div>
                    <span>${title}</span>
    `;
    categorySwiperSlide.className = "swiper-slide";
    if (idx == 0) {
        categorySwiperSlide.classList.add("select");
    }
    categorySwiperSlide.innerHTML = imgHtml;
    return categorySwiperSlide;
}

function appendDetailSlide(src, title) {
    let detailSwiperSlide = document.createElement("div");
    let titleText = title !== undefined ? title : "";
    let imgHtml = ` <div class="lookbook-detail">
                        <img src="${src}" alt="">
                    </div>
    `;
    detailSwiperSlide.className = "swiper-slide";
    detailSwiperSlide.innerHTML = imgHtml;
    return detailSwiperSlide;
}

function appendRelatedSlide(src, title) {
    let relatedSwiperSlide = document.createElement("div");
    let imgHtml = ` <div class="related-box">
                        <img src="${src}" alt="">
                    </div>
                    <span class="related-title">${title}</span>
    `;
    relatedSwiperSlide.className = "swiper-slide";
    relatedSwiperSlide.innerHTML = imgHtml;
    return relatedSwiperSlide;
}

function slideClickEvent() {
    let slide = document.querySelectorAll(".lookCategory-swiper .swiper-slide");
    let lookbookTitle = document.querySelectorAll(".lookbook-title");
    slide.forEach(el => el.addEventListener("click", function () {
        slide.forEach(el => {
            el.classList.remove("select")
        });
        this.classList.add("select");
        let title = this.children[1].innerHTML;
        let click = lookbookCategorySwiper.clickedIndex;
        console.log("🏂 ~ file: lookbook.js:368 ~ slide.forEach ~ click", click)
        lookbookTitle.forEach(el => el.innerHTML = title)
    }))
}


function scrollTop() {
    let topBtn = document.querySelector(".lookbook-top-btn");
    topBtn.addEventListener("click", function () {
        window.scroll({
            top: 0,
            left: 0,
            behavior: 'smooth'
        });
    })
}


function backBtn() {
    let backBtn = document.querySelectorAll(".back-btn");
    let lookbookWrap = document.querySelector(".lookbook-wrap");
    let lookbookDetailWrap = document.querySelector(".lookbook-detail-wrap");
    backBtn.forEach(el => {
        el.addEventListener("click", function () {
            lookbookWrap.classList.add("open");
            lookbookDetailWrap.classList.remove("open");
        })
    })
}

function lookbookClickEvent() {
    let lookbookWrap = document.querySelector(".lookbook-wrap");
    let lookbookDetailWrap = document.querySelector(".lookbook-detail-wrap");
    let lookbooks = document.querySelectorAll(".lookbook-wrap .lookbook");
    lookbooks.forEach((el, idx) => el.addEventListener("click", function () {
        lookbookWrap.classList.remove("open");
        lookbookDetailWrap.classList.add("open");
        lookbookDetailSwiper.slideTo(idx);
    }))
}





let lookbookCategorySwiper = new Swiper(".lookCategory-swiper", {
    // slidesPerView:'auto',
    slidesPerView: 'auto',
    spaceBetween: 10,
    navigation: {
        nextEl: ".look-header-wrap .swiper-button-next",
        prevEl: ".look-header-wrap .swiper-button-prev",
    }

})
let lookbookDetailSwiper = new Swiper(".lookbook-detail-swiper", {
    slidesPerView: 'auto',
    slidesPerView: 1,
    navigation: {
        nextEl: ".lookbook-detail-wrap .swiper-button-next",
        prevEl: ".lookbook-detail-wrap .swiper-button-prev",
    },
    pagination: {
        el: '.lookbook-detail-wrap .swiper-pagination',
        type: 'fraction',
    }
})
let relatedSwiper = new Swiper(".related-product-swiper", {
    slidesPerView: 'auto',
    slidesPerView: 3.5,
    spaceBetween: 10,
    navigation: {
        nextEl: "#related-wrap .swiper-button-next",
        prevEl: "#related-wrap .swiper-button-prev",
    }
})
function titleFooterObserver() {
    let observer;
    let options = {
        root: null,
        rootMargin: '0px',
        threshold: 0
    }
    let target = document.querySelector("footer")
    observer = new IntersectionObserver((entries) => {
        const $body = document.querySelector("body");
        let titlebox = document.getElementsByClassName("lookbook-title-box");
        entries.forEach(entry => {
            if (entry.isIntersecting && !$body.classList.contains("m_menu_open")) {
                let footerHeight = entry.boundingClientRect.height;
                let topbtn = document.querySelector(".lookbook-top-btn").offsetHeight;
                titlebox[0].style.bottom = "43%";
                if (document.querySelector("#related-wrap.mobile") !== null) {
                    document.querySelector("#related-wrap.mobile").style.bottom = `${footerHeight}px`;
                }
            } else {
                titlebox[0].style.bottom = "10%";
                if (document.querySelector("#related-wrap.mobile") !== null) {
                    document.querySelector("#related-wrap.mobile").style.bottom = `0px`;
                }
            }
        });
    }, options);
    observer.observe(target);
}
function responsive() {
    let breakpoint = window.matchMedia('screen and (max-width:1025px)');
    if (breakpoint.matches === true) {
        document.getElementById("related-wrap").classList.add("mobile");
        document.getElementById("related-wrap").classList.remove("web");
    } else if (breakpoint.matches === false) {
        document.getElementById("related-wrap").classList.add("web");
        document.getElementById("related-wrap").classList.remove("mobile");
    }
}